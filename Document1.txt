The NTFS file system views each file (or directory) as a set of file attributes. Elements such as the file's name, its security information, and even its data, are all file attributes. Each attribute is identified by an attribute type code and, optionally, an attribute name.

What is the first and last cluster number allocated to this file? This information is often found on the last line of the istat output as a list of numbers.

The fsstat command displays file system information. Data of particular interest in the output of this command vary depending on the file system being examined but may include volume names, data unit sizes, and statistical information about the state of the file system.

The fls list files and directory information from an image, along with inode information. The icat command reads the contents of a file, and the istat command allows access to the file metadata.

Remember that there are four sectors to a cluster, so unneeded sectors left in a partially used cluster are still counted when calculating the last sector allocated

Most of the forensic tools are able to read and present metadata information regarding files and directories. In case of file system corruption or just data verification it is essential that you can manually verify metadata information stored in the file system.

If the first byte of a FAT entry is 0xe5 then this indicates that the entry has been deleted.

this cluster number, if you wish to convert it into a partition sector number, is first added to the Total Cluster Range low boundary as reported by fsstat. It is then multiplied by the blocks per cluster (e.g. 4), then the Cluster Area low boundary is added.

The Extended FAT (exFAT) file system was released in 2006 by Microsoft to provide improvements
on the earlier FAT system while remaining a relatively simple and lightweight file system, ideal for
removable storage media or portable devices. exFAT improvements include larger volume and file
sizes, and extra resilience with backup boot sectors and checksums.

The File Allocation Table is used by the system to maintain a linked list of the clusters allocated to
each file. In exFAT, FAT table entries are 4 bytes long. The first cluster allocated to a file is stored in
the File Directory Entry. This initial cluster is then used as an index into the FAT. If the cluster run for
the file has further clusters then the next cluster address will be stored in that FAT entry. The end of
a cluster run is marked by 0xffffffff in the table entry. This mechanism provides a linked list of
clusters allocated to a file. The first two entries in the FAT are reserved and contain signatures rather
than cluster addresses. This ties in with the fact that the first cluster address of the Data Region is 2.
Note that unlike earlier FAT file systems, a FAT entry value of non-zero does not indicate that a
cluster is allocated. In exFAT, the system tracks the allocation status of clusters in the Allocation
Table.

The device file "/dev/zero" produces an infinite number of 0 bytes (i.e. a long string of 0x00). This can be useful if you want to produce a file with all the data set to 0.

In this set of questions we are going to access disks and disk images which have been created under operating systems other than Linux. This can lead to some inconsistences.

In some images the idea of physical C/H/S and the logical C/H/S being identical is lost. This can happen for a variety of reasons, such as errors in the disk capture or simply bugs or misunderstandings by the code which originally formatted the disk. Additionally the BIOS usually tries to report geometry, but for a captured disk image the BIOS does not know the disk geometry. So dont worry about errors like "cannot get geometry". Usually geometry is stored in the partition table too, and the tools we use can access this.

Lastly, linux likes partitions to use all available space, but some systems perfer to stop partitions on a cylinder boundary. So do not worry too much about expected/found errors involving C/H/S where "found" indicates a cylinder end and "expected" is just slightly more space...

We are going to mount the disk image in such a way as to be able to use standard Linux command to see what is on the disk image. To do this you need a loop device. Loop devices are numbered 0 to 9, and for instance the first loop device is called /dev/loop0. Loop devices allow you to like a file to a disk device, thus allowing you to use your linux disk commands on disk images as well as normal disks. In this way /dev/loop0 is similar in functionality to /dev/sdd.

In this section we will look at a concept called Snapshots. In the previous question we mounted via a loop device a disk image /images/usbimg1.dd. However, we could only mount this read only. Taking a disk image and then forensically examining it, while making sure it is not changed, is important as this ensures we are not introducing things into evidence accidentally.

However, sometimes a disk image needs to be changed as part of an investigation. This could be to correct an error which is stopping us conducting the investigation. An example of this could be that the partition table is damaged and thus we cannot access the partitions and files. There are tools available to correct damaged partition tables, but these require write access to the image.

One approach to solving this would be to take a second disk copy and make changes to that, but that could easily be hundreds of gigabytes or more. Instead, we will look at a way of accessing a read only image in a way that writes seem to work, but with the writes going to a seperate file. In this way the original image is still safe, and we can make changes to the way we see this disk in a safe and efficient manner.

For the purposes of learning about snapshots, we are going to mount the usbimg1.dd disk image in a way that the image itself is read only, but that we can add a small file to the mount data.

Guymager is a forensic imaging tool with a graphical interface. The forensic imager was designed to support different image file formats, to be most user-friendly and to run fast. It has a high speed multi-threaded engine using parallel compression for best performance on multi-processor and hyper-threading machines.

Features include:

Fast due to multi-threaded, pipelined design and multi-threaded data compression
Easy user interface available in different languages
Generates flat (dd), EWF (E01) and AFF images, supports disk cloning
Extended acquisition info file

1 When people use computers, they will leave signs of what they have done. This could be in log files, or in active data files, or perhaps in deleted information which may still live in the hard drive in one form or another. This principle of forensics is known as what?
Locard's Exchange Principle


2 How does Brian Carrier define the concept of Digital Evidence?How does Brian Carrier define the concept of Digital Evidence?
Digital Evidence is a digital object that contains reliable information that supports or refutes a hypothesis.


3 In terms of Characteristics of Evidence, which term relates to the concept that the data itself can be easily damaged, lost, or destroyed?
Data is Fragile


4 Many believe that the investigation process is a 4 step process.
Step 1, Acquisition, Step 3, Evaluation, and Step 4, Presentation.
What is considered to be step 2? Explain this step.
Identification

This step involves identifying what data could be recovered and electronically retrieving it by running various Computer Forensic tools and software suites

5 There are many challenges and research areas for the future of forensics. Consider the topic of GPU-based malware (where malware in a PC lives in the graphics card and uses the graphics card processor to perform its malware activities). What forensic challenges would such a malware pose?
Similar to RAM-only malware, if the PC is rebooted the malware may be lost. Tools used to scan PC memory and hard drives may struggle to scan GPU memory. Very difficult to trace and analyse, and each version of the malware may be very different depending on the GPU used. Nvidea high-end graphics cards would seem to be a good target for such malware, and this whole domain is a very active research area.


6 In this course we use Caine as for instance it allows us to explore some quite low level aspects of forensics which may be more hidden behind layers of interfaces in other products. But in the real world why might someone use Caine over a more commercial offering (such as Encase)?
Caine is obviously cheaper, and thus maybe the tool of choice for non-criminal investigations (such as employer internal investigations). It may also be popular where costs are a concern. By having low-level interfaces it does help when investigating new file systems which are not yet well supported in the commercial world. It allows us to validate facts generated by other tools. Caine is also well respected, and can perform as well as encase can in general.It is also a good platform for research.


7 Given the following information from an "ls -l" command, find the biggest file and justify your answer.

-rw-r--r-- 2   caine caine 1 2016-01-19 11:29 item1
drwxr-xr-x 2   caine caine 4096 2016-01-19 11:29 item2
drwxr-xr-x 217 caine caine 4096 2016-01-19 11:29 item3
-rw-r--r-- 20  caine 40    2 2016-01-19 11:29 item4
-rw-r--r-- 2   caine caine 20 2016-01-19 11:29 item5
-rw-r--r-- 60  caine caine 2 2016-01-19 11:29 90
drwxr-xr-x 2   caine caine 9090 2016-01-19 11:29 item7

Lines which start with "d" are directories not files. Their size is meaningless.

Size comes straight after the group information, so the biggest size is item5 with a size of 20 bytes.


8 Consider the following commands.

$ cd /home/caine
$ cd test2/test3/../test4
$ cd ../test5
$ pwd
Assuming all the commands completed without error, what would the output of pwd be?

/home/caine/test2/test5

9 Using the ls command, provide a single line command (using pipes) to find all the files and directories (not recursively) in /home which contain the letter "a" in the title, and of those save the 2nd, 3rd, and 4th such file found to a new file "file2" in /tmp . You should make use of filename expansions rather than grep.

ls /home/*a* | head -4 | tail -3 > /tmp/file2


10 Consider the following permissions for a file called "file1".

-rwx-wx-w-
Using the chmod command in symbolic mode, change the permissions to

-rw-r-x-wx
Use only "+" and or "-". You can use more than 1 chmod command if you wish.

chmod u-x,g-w+r,o+x file1

or

chmod u-x file1
chmod g-w file1
chmod g+r file1
chmod o+x file1

11 Consider the following:

$ ls
file1     file2
$ ls -l file1
-rw-rw-r--.  1 gordon users          21 Jul  2  2015 file1
$ ls -l file2
-rw-rw-r--.  1 gordon users          21 Jul  2  2015 file10
Why does the second ls command show information for "file10" not "file2" as asked?


"file2" is actually a directory, and to see a directory you need to do "ls -ld file". Best practice when investigating a file is to always do -d until you know for sure it is a file. Dont be fooled by just the name of the file or directory when trying to work out what something is.

12 Consider the following information produced from an "ls -l".

----r--r--. 1 caine caine  187  Jan 30 11:51 file1
-rw-rw----. 1 caine staff  374  Jan 30 11:51 file2
-rwx-w-r--. 1 gordon caine 374  Jan 30 11:51 file3
-rw-rwxr--. 1 gordon staff 374  Jan 30 11:51 file4
If I was logged in as user "caine" in group "caine", what files could I read?


Just file2 and file4, You might feel that file1 should be accessible, but as the owner information matches then ONLY that one is used to decide access. File3 group matches, but it is only write access not read.


12A A file currently has the following permissions for "file1".

-rw-r-x-w-
Given the current permissions, add group write, remove user read, and add execute to others. Use chmod in NUMERIC mode.

chmod 0273 file1


14 What is meant by a hash collision? Use md5 as an example, and discuss your answer in terms of forensics.

Take a md5sum of two files. If the hash is the same then the files may also be identical. However if the hash is the same and the files are not identical then this is a hash collision. This occurs rarely, but the likelihood of it occurring is related to the soundness of the function as well as the number of bits used to define each hash. Searching for files using hashes as part of a forensics investigation could lead to poor conclusions if hash collisions occurred. Ultimately where this is a danger then a better hash function should be selected.


15 Use the find command and show the command needed to find all files in /etc which are owned by gordon with a size GREATER than 200 bytes.

find /etc -user gordon -size +200c


16 Write a regular expression which, when used in grep command to search a file of dictionary words, would find all words which have exactly 5 letters in them, of which the last letter is a "z".

^....z$


17 Write a regular expression, that when used with grep on a file containing dictionary words, would find all words which end with the same 2 letters which the word starts with, but reversed. The words can be of any length.

So for instance you could find:

turnout (start tu and ends ut).

thought (starts th and ends ht).

^(.)(.).*\2\1$


18 Write a grep command which will look through a file called "file1" and find all lines which contain the word "petra". Make the search case insensitive, and show 2 lines before and 1 line after each match.

grep -A 1 -B 2 -i petra file1


19 You were conducting a forensic examination of a colleague's PC in order to understand what a hacker had been able to access. You got bored and started flicking through the colleague's photos, and discovered images you find distasteful and possible illegal. You dont like your colleague anyway, as he has recently applied for the same job you have. Discuss the ethics of your next steps?

Seems like a breach of ethics and procedures to go off and look at things which are out of bounds. Yet is it ethical to ignore what you have discovered? In UK law it seems fair game to use this information, but no doubt your company would expect you to have set up the boundaries for your investigation and you seemed to have overstepped the line... There does also seem to be a conflict of interest here. Ultimately you should fall back onto the written processes and if still unsure then one approach would be to ask for someone else to deal with the original investigation.This is definitely the case that having detailed procedures would help enormously.


20 During a forensics investigation lasting years, you discover that the original drive has been lost. You still have an image you acquired from the disk when the investigation began. Discuss any issues you feel is relevant when discussing the soundness of the resulting investigation.

If the disk was acquired using proper procedures, and a hash taken and noted in your logbook, then it seems almost certain that it is still sound to continue using only the image. Lack of proper procedures, or questionable validation procedures, might leave you open to acquisition that you (or another) have tampered with the image. In fact this situation is not unknown in criminal cases, where sometimes hard drives die before the case comes to court, and it is generally accepted that the image is still acceptable as long as the process is valid and reasonably sound. 